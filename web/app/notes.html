<!doctype html>
<html lang="en" xmlns:ng="http://angularjs.org/" ng-app="slides">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>React - Speaker Notes</title>
</head>

<body ng-controller="SlideCtrl" slideshow>

<!--
    Still need to comment on:
        * statful/stateless
-->

    <slide><ul>
        <li>You are Chris. Author of Ratchet, co-author of React</li>
        <li>Open source enthusiast, passion for real-time applications</li>
        <li>I'd tell you a UDP joke, but you might not get it</li>
    </ul></slide>
    
    <slide><ul>
        <li>url maps to filesystem</li>
        <li>php is executed and rendered in browser as html/css/javascript</li>
        <li>evolution to mod_rewrite to direct all traffic to single script which routes itself</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>client opens a socket connection</li>
        <li>requests a page</li>
        <li>server response with another HTTP message, usually html, closes connection</li>
        <li>stateless</li>
    </ul></slide>

    <slide><ul>
        <li>Transmission Control Protocol - ensures delivery in the order it was sent</li>
        <li>layers, wrapped.  this is sent both ways through the connection</li>
        <li>A tcp packet walks in to a bar and says "I want a beer", barman says "you want a beer?" and tcp packet says "yes, a beer"</li>
    </ul></slide>

    <slide><ul>
        <li>error in diagram - no cloud in localhost</li>
        <li>running processes communicating with each other</li>
        <li>your request will eventually get routed to its destination</li>
        <li>who's configured a server before?</li>
        <li>goto: 10 or 15</li>
    </ul></slide>

    <slide><ul>
        <li>like a telephone</li>
        <li>http is more like telegram</li>
    </ul></slide>

    <slide><ul>
        <li>strip away a layer</li>
        <li>curl removes the html rendering, css styling, and javascript execution</li>
    </ul></slide>

    <slide><ul>
        <li>strip away another</li>
        <li>one server can host multiple domains. must Host: header specifies which domain you're asking for</li>
    </ul></slide>

    <slide><ul>
        <li>below the tcp layer is the IP layer</li>
        <li>only one process can be bound to a port</li>
        <li>goto: 6 -- remove nginx/fpm</li>
    </ul></slide>

    <slide><ul>
        <li>5.4, testing only, blocking</li>
    </ul></slide>

    <slide><ul>
        <li>one at a time</li>
        <li>if multiple clients make a request the server must finish executing one before it can handle the next</li>
        <li>single lane traffic on the highway with a slow truck leading the way</li>
    </ul></slide>

    <slide><ul>
        <li>mysql is another process you communicate with over sockets</li>
        <li>server side script talks to it and waits</li>
        <li>a blocking process can talk to a non-blocking</li>
        <li>the async can deal with things while the sync waits</li>
    </ul></slide>

    <slide><ul>
        <li>loops waiting for an event to happen, when an event happens it executes code and waits for the next event</li>
        <li>This loop will get bigger and longer the more execution is done per tick</li>
    </ul></slide>

    <slide><ul>
        <li>the smaller each unit is the less prone it is to error</li>
        <li>it's easier to test small applications</li>
        <li>goto: 6</li>
    </ul></slide>

    <slide><ul>
        <li>assembly line</li>
        <li>each process doing one small thing makes an entire system faster</li>
        <li>each process is only waiting on its one task</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>routes connections to services</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>React - is a PHP library with its core being a reactor pattern</li>
        <li>Installed with packagist/composer</li>
        <li>PSR-2, unit tested, blah, blah, blah</li>
        
    </ul></slide>
    
    <slide><ul>
        <li>PHP, as of 5.3, has had garbage collection</li>
    </ul></slide>
    
    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>intro - uses javascript like event syntax</li>
        <li>when a connection is established to the server from the client a new Connection object is created</li>
        <li>When that connection receives new data from the client we'll send it back</li>
        <li>telnet demo</li>
    </ul></slide>

    <slide><ul>
        <li>in a traditional http request/response each connection is silo'd into a private php runtime</li>
        <li>in React a single script houses all connections into a single run time</li>
        <li>each connection houses its own context, there are no global variables</li>
        <li>how to communicate between connections, demo</li>
    </ul></slide>

    <slide><ul>
        <li>true reactor, multiple services, re-directing traffic</li>
        <li>sudo hierarchical architecture</li>
        <li>demo</li>
    </ul></slide>

    <slide><ul>
        <li>that's how you talk to processes, but what good is it?</li>
        <li>how systems agree to communicate with eachother</li>
        <li>unstructured, raw data</li>
    </ul></slide>
    
    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>Igor wrote async DNS for PHP</li>
        <li>goto: 36</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>Redis done by nrk</li>
    </ul></slide>

    <slide><ul>
        <li>socket - open sockets, binds to ports, communicates over tcp</li>
        <li>stream - wrapper with helpers, underlying socket, will be used for EIO</li>
        <li>promise - answer to nested callbacks (more later)</li>
        <li>dns - async dns lookup</li>
        <li>zmq - wizardry, tcp on steroids</li>
        <li>stomp - text based protocol (more later)</li>
    </ul></slide>
    
    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>stream_select is slow</li>
        <li>libevent handles thousands</li>
        <li>libevent was created to solve C10K problem</li>
        <li>libev modelled after libevent without "limitations or bugs"</li>
        <li>libuv made by Joyent for node, libev API but for Windows</li>
    </ul></slide>

    <slide><ul>
        <li>Who's ever written something (in any language) where you want to do things in a row?</li>
    </ul></slide>

    <slide><ul>
        <li>A promise like a one time stream (go look up quote)</li>
        <li>instead of callbacks you're giving a promise object</li>
        <li>at some point it will be fulfilled or broken</li>
        <li>The server can choose to respond to it at any time</li>
        <li>The promise can be reused and the work is only done once</li>
        <li>Memoization</li>
    </ul></slide>
    
    <slide><ul>
        <li>Connecting to a server using a URL makes 2 calls</li>
        <li>First a DNS lookup needs to be done</li>
        <li>PHP/TCP by default is blocking</li>
        <li>goto: 28</li>
    </ul></slide>
    
    <slide><ul>
        <li>Once a promise has been completed the value is restored but the API remains the same</li>
    </ul></slide>
    
    <slide><ul>
        <li>The deferred object is behind the scenes of a promise</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>Don't keep any state by storing variables</li>
        <li>Helps prevent race conditions</li>
        <li>Async, the requests are made in parallel</li>
    </ul></slide>
    
    <slide><ul>
        <li>Streams are an API wrapper for handling I/O</li>
        <li>This could be the filesystem or sockets (here it's sockets)</li>
        <li>Makes manipulating data for connections easier</li>
    </ul></slide>

    <slide>(ReadableStreamInterface)<ul>
    </ul></slide>

    <slide>(WritableStreamInterface)<ul>
    </ul></slide>

    <slide><ul>
        <li>0.4 coming soon</li>
        <li>Fushion</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>Most often used by and meant for browsers</li>
        <li>But HTTP is stateless, how does this work?</li>
    </ul></slide>

    <slide><ul>
        <li>Remember stateless request/response that is HTTP</li>
        <li>Hold open an HTTP connection like a door</li>
        <li>Decide to speak a different protocol</li>
    </ul></slide>

    <slide><ul>
        <li>Take a stateful protocol like TCP</li>
        <li>Create a stateless protocol on top of it like HTTP</li>
        <li>Make that stateless protocol stateful by not closing it</li>
    </ul></slide>

    <slide><ul>
        <li>Show debug inspector WebSocket request</li>
    </ul></slide>

    <slide><ul>
        <li>It's all about the protocol</li>
        <li>But that's not important to most developers</li>
        <li>The API is what's important (until something breaks)</li>
    </ul></slide>

    <slide><ul>
        <li>So what can we do with this technology?</li>
        <li>Live data to/from users</li>
        <li>draw something</li>
    </ul></slide>

    <slide><ul>
        <li>any takers?</li>
        <li>Talk is on Ratchet but principles are language agnostic</li>
        <li>Built on top of React</li>
    </ul></slide>

    <slide><ul>
        <li>RFC is the binary protocol end points agree to communicate with</li>
        <li>Ratchet also supports Hixie76 for some ppl on Safari</li>
    </ul></slide>

    <slide><ul>
        <li>events are triggered on both server and client side</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>copy/paste for demo</li>
    </ul></slide>

    <slide><ul>
        <li></li>
    </ul></slide>

    <slide><ul>
        <li>chat in ratchet, hello world, same as react</li>
    </ul></slide>

    <slide><ul>
        <li>binding class to reactor</li>
        <li>demo app code, show decorator, routing, PIE not NIH</li>
        <li>0.3 only</li>
        <li>still just raw, unstructured, data</li>
        <li>Real facade</li>
    </ul></slide>

    <slide><ul>
        <li>decorator pattern, layers, unix philosophy</li>
        <li>allows it to be future proof</li>
        <li>I/O is binding to React's javascript api</li>
        <li>StackPHP?</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>
    
    <slide><ul>
        <li>python guy hasn't heard of windows</li>
    </ul></slide>

    <slide><ul>
        <li>protocol messages</li>
    </ul></slide>

    <slide><ul>
        <li>connection is a highway</li>
        <li>topic are lanes in the highway</li>
    </ul></slide>

    <slide><ul>
        <li>rpc is promise</li>
        <li>instead of callbacks you're giving a promise object</li>
        <li>at some point it will be fulfilled or broken</li>
        <li>The server can choose to respond to it at any time</li>
    </ul></slide>

    <slide><ul>
        <li>WAMP boilerplate in Ratchet</li>
        <li>Show topic code</li>
    </ul></slide>
    
    <slide><ul>
        <li>copy/paste for demo</li>
    </ul></slide>
    
    <slide><ul>
        <li>Any volunteers?</li>
        <li>JavaScript client library exists</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>
    
    <slide><ul>
    </ul></slide>
    
    <slide><ul>
        <li>May be blocked by some proxies, 3 second wait</li>
    </ul></slide>

    <slide><ul>
        <li>Flash universally supported, including Ratchet</li>
        <li>SockJS tries WS, falls back to other HTTP methods</li>
        <li>Socket.IO opens long polling, opens second WebSocket conn, wasteful</li>
    </ul></slide>

    <slide><ul>
        <li>SSL is too slow, unix philosophy</li>
        <li>Proxies take care of things like timeouts</li>
    </ul></slide>

    <slide><ul>
        <li>Carries messages across inproc, IPC, TCP, and multicast.</li>
        <li>Connect N-to-N via fanout, pubsub, pipeline, request-reply.</li>
        <li>Asynch I/O for scalable multicore message-passing apps.</li>
        <li>Large and active open source community.</li>
        <li>One language library with bindings for 40+ languages</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>5000 concurrent connections</li>
        <li>Right tool for the right job</li>
        <li>If you're not already polyglot maintaining another lang is a cost</li>
    </ul></slide>

    <slide><ul>
        <li>When should you opt for a different language?</li>
        <li>When PHP isn't enough</li>
        <li>Node isn't necessarily the answer</li>
    </ul></slide>

    <slide><ul>
        <li>Communicate with other running applications via sockets + a protocol</li>
        <li>Canned solutions are available</li>
        <li>Pusher, RabbitMQ</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <slide><ul>
        <li>hello? yes, you are dog</li>
        <li>Ratchet 0.1 on socketo.me -- React disconnect + GC faster than Ratchet ->detach()</li>
    </ul></slide>

<!--
    <slide><ul>
    </ul></slide>
-->

    <slide><ul>
        <li>HHVM requires libevent but doesn't expose an API for it</li>
        <li>soon?</li>
        <li>Sessions are currently blocking :(</li>
        <li>Socket.IO has progress</li>
        <li>Binary message support is in the code, not the API</li>
        <li>API's are hard</li>
    </ul></slide>

    <slide><ul>
    </ul></slide>

    <div id="slideCounter">
                         <span ng-controller="OnlineCtrl" title="Live slideshow status">{{status}}</span> 
        &nbsp; -- &nbsp; <span title="Slide number/total">{{currentSlide}} / {{slideCount}}</span> 
    </div>
</body>
    <script>var addPath = '/notes';</script>

    <script>
        var addPath = '';
        window.define = function(factory) {
            try{ delete window.define; } catch(e){ window.define = void 0; } // IE
            window.when = factory();
        };
        window.define.amd = {};
    </script>

    <script src="bower_components/when/when.js"></script>
    <script src="bower_components/autobahnjs/autobahn/autobahn.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/angular-ui-router/release/angular-ui-router.js"></script>
    <script src="bower_components/SyntaxHighlighter/scripts/XRegExp.js"></script>
    <script src="bower_components/SyntaxHighlighter/scripts/shCore.js"></script>
    <script src="bower_components/SyntaxHighlighter/scripts/shBrushJScript.js"></script>
    <script src="bower_components/SyntaxHighlighter/scripts/shBrushXml.js"></script>
    <script src="bower_components/SyntaxHighlighter/scripts/shBrushPhp.js"></script>
    
    <link rel="stylesheet" href="styles/fonts.css" type="text/css">
    <link rel="stylesheet" href="bower_components/SyntaxHighlighter/styles/shCore.css" type="text/css">
    <link rel="stylesheet" href="bower_components/SyntaxHighlighter/styles/shThemeDefault.css" type="text/css">
    <link rel="stylesheet" href="styles/presentation.css" type="text/css">

    <script src="scripts/slide.js"></script>
    <script src="scripts/slide-directives.js"></script>
</html>